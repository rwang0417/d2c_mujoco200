%% system parameters
ctrl_num = 1;
state_num = 2;
%% dlqr
s = load('linearization_top.txt');
% s=[1.0202    0.0572   -0.0190    0.0001   -0.0043;
%     0.7058    1.0154   -0.6694   -0.0063   -0.1888;
%    -0.0261   -0.0002    1.0701    0.0569    0.0138;
%    -0.9236   -0.0093    2.4715    1.0357    0.6037];
Q = [1 0;
     0 30];
R = 0.01;
[Kd,ss,e] = dlqr(s(:,1:state_num),s(:,state_num+1:state_num+ctrl_num),Q,R);
Kd

% function LinearResult
% s = load('linearization_top.txt');
% u=[s(1,:);s(2,:);s(3,:);s(4,:);s(5,:)];
% y=[s(6,:);s(7,:);s(8,:);s(9,:)];
% Ts = 0.05;
% I = [1 0 0 0;0 1 0 0;0 0 1 0;0 0 0 1];
% Q = [1 0 0 0;0 1 0 0;0 0 1 0;0 0 0 1];
% h = y*u'/(u*u')
% % s=[1.000715112243132   0.056503191316426   0.000409782691076  -0.006907030068329  -0.003070122484340
% %    0.694843609170095   0.995547680736424  -0.654431988174155   0.001301067996054  -0.205940308026957
% %   -0.007560478375109   0.013680515439922   1.081175960801794   0.059157873565087   0.032357596602689
% %   -0.883845258052507   0.032471974390531   2.500544649442402   1.055570476999023   0.676141829512635]
% Ad = [h(:,1) h(:,2) h(:,3) h(:,4)];
% Bd = h(:,5);
% A=(Ad-I)/Ts;
% B=Bd/Ts;
% [Kd,ss,e] = dlqr(Ad,Bd,Q,0.5);
% [K,S,e] = lqrd(A,B,Q,0.5,Ts);
% Kd
% K
% end